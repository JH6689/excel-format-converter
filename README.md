# Excel 格式轉換工具

將排班表 Excel 檔案轉換為任務代碼格式，支援 Google Sheets 對照表整合。

## 線上使用

**網址：** https://jh6689.github.io/excel-format-converter/

## 功能說明

- 上傳 Excel 檔案，讀取「總控」表單
- 設定轉換年月（預設為下個月）
- 設定早班/中班/晚班切分點
- 整合 Google Sheets 對照表：
  - 員工姓名 → 工號
  - 班別 → 任務代碼
- 輸出轉換結果 Excel 檔案

## 班別切分邏輯

| 班別 | 預設時間範圍 |
|------|-------------|
| 早班 | ≤ 1050 |
| 中班 | 1051 - 1149 |
| 晚班 | ≥ 1150 |

切分點可自行調整。

## 輸入檔案格式

Excel 檔案需包含名為「總控」的表單：

| 日期 | 10-01(三) | 10-02(四) | 10-03(五) | ... |
|------|-----------|-----------|-----------|-----|
| 員工A | 1020 | 1120 | ① | ... |
| 員工B | 1150 | 1015 | 年 | ... |

- 第一欄：員工姓名
- 後續欄位：該月每日的班別時間
- 3-4 位數字視為班別時間（如 1020、1150）
- 其他內容（圈號、數字、「年」等）不轉換

## 輸出格式

| 日期 | 工號 | 任務代碼 |
|------|------|----------|
| 2025-10-01 | 0001 | 11 |
| 2025-10-02 | 0001 | 22 |

## Google Sheets 對照表設定

### 員工工號對照表

| 姓名 | 工號 |
|------|------|
| 員工A | 0001 |
| 員工B | 0002 |

### 任務代碼對照表

| 名稱 | 代碼 |
|------|------|
| 總控早 | 11 |
| 總控中 | 22 |
| 總控晚 | 33 |

**注意：** Google Sheets 需設為「公開」才能讀取。

## 本地開發

```bash
# 安裝依賴
npm install

# 啟動伺服器（Node.js 版本）
npm start

# 開啟瀏覽器
open http://localhost:3000
```

## 技術架構

- **前端**：HTML + JavaScript + [SheetJS (xlsx)](https://sheetjs.com/)
- **後端**：Node.js + Express（本地版本）
- **部署**：GitHub Pages（純前端版本）

## 授權

MIT License
